<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png"/><link rel="manifest" href="/assets/site.webmanifest"/><link rel="mask-icon" href="/assets/safari-pinned-tab.svg" color="#5bbad5"/><link rel="shortcut icon" href="/assets/favicon.ico"/><meta name="msapplication-TileColor" content="#da532c"/><meta name="msapplication-config" content="/assets/browserconfig.xml"/><meta name="theme-color" content="#ffffff"/><link href="https://fonts.googleapis.com/css?family=Source+Serif+Pro:400,700&amp;display=swap" rel="stylesheet"/><title>A static blog? - prk3 blog</title><meta name="author" content="PrzemysÅ‚aw Kukulski"/><meta name="keywords" content="markdown,nextjs"/><meta name="description" content="Following the hype, I wanted to play with the new generation of static page generators. Without too much thinking I started writing this personal blog in Next.js. As I later discovered, Next has a different purpose. Let me tell you about the creation of this static blog and my adventure with Next.js."/><meta name="next-head-count" content="16"/><link rel="preload" href="/_next/static/css/1a244f8410e88c24e9bc.css" as="style"/><link rel="stylesheet" href="/_next/static/css/1a244f8410e88c24e9bc.css"/></head><body><div id="__next"><div class="Post"><header class="PostHeader"><picture class="PostHeaderImg"><source type="image/webp" media="(max-width:  480px)" srcSet="/assets/a-static-blog/header-s-2x.webp   960w, /assets/a-static-blog/header-s-1x.webp   480w"/><source type="image/webp" media="(max-width:  960px)" srcSet="/assets/a-static-blog/header-m-2x.webp  1920w, /assets/a-static-blog/header-m-1x.webp   960w"/><source type="image/webp" media="(max-width: 1440px)" srcSet="/assets/a-static-blog/header-l-2x.webp  2880w, /assets/a-static-blog/header-l-1x.webp  1440w"/><source type="image/webp" media="(max-width: 1920px)" srcSet="/assets/a-static-blog/header-x-2x.webp  3840w, /assets/a-static-blog/header-x-1x.webp  1920w"/><source type="image/webp" srcSet="/assets/a-static-blog/header-xx-2x.webp 5120w, /assets/a-static-blog/header-xx-1x.webp 2560w"/><source type="image/jpg" media="(max-width:  480px)" srcSet="/assets/a-static-blog/header-s-2x.jpg   960w, /assets/a-static-blog/header-s-1x.jpg   480w"/><source type="image/jpg" media="(max-width:  960px)" srcSet="/assets/a-static-blog/header-m-2x.jpg  1920w, /assets/a-static-blog/header-m-1x.jpg   960w"/><source type="image/jpg" media="(max-width: 1440px)" srcSet="/assets/a-static-blog/header-l-2x.jpg  2880w, /assets/a-static-blog/header-l-1x.jpg  1440w"/><source type="image/jpg" media="(max-width: 1920px)" srcSet="/assets/a-static-blog/header-x-2x.jpg  3840w, /assets/a-static-blog/header-x-1x.jpg  1920w"/><source type="image/jpg" srcSet="/assets/a-static-blog/header-xx-2x.jpg 5120w, /assets/a-static-blog/header-xx-1x.jpg 2560w"/><img class="PostHeaderImg__img" src="/assets/a-static-blog/header-m-1x.jpg" alt="header image" style="color:#141407;background-color:#141407"/></picture><div class="PostHeader__navContainer"><div class="PostHeader__navColumn"><nav><a class="PostHeader__logo" href="/">prk3</a></nav></div></div><div class="PostHeader__titleContainer"><div class="PostHeader__titleColumn"><h1 class="PostHeader__title">A static blog?</h1><h2 class="PostHeader__author">PrzemysÅ‚aw Kukulski</h2><h3 class="PostHeader__date"><time dateTime="Mon May 25 2020 02:00:00 GMT+0200 (Central European Summer Time)">May 25, 2020</time></h3><div class="PostHeader__tags"><a class="Tag Tag--light" style="background-color:#000000" href="/tags/markdown">Markdown</a><a class="Tag Tag--light" style="background-color:#000000" href="/tags/nextjs">Next.js</a></div></div></div></header><div class="Post__body"><div class="Post__bodyColumn fancy"><h1>The idea</h1><p class="fancy__textFirstParagraph">In late 2010s static site generators hit the mainstream once again. Quite a surprising turn considering that the tech world generally heads towards interactivity, which is not a strong side of static pages. So... why did that happen? I can think of four possible reasons. First of all, static pages load instantly, as they are pre-rendered and don&#x27;t contain heavy JavaScript. Secondly, static sites can be hosted cheaply just about anywhere. Another benefit is the lack of maintenance overhead. No security patches and no database backups needed, how does that sound? The last reason, and probably the most relevant one, is <strong>nostalgia</strong>. Web developers, just like other homo sapiens, can sometimes look at the world through rose-tinted glasses. Serving static HTML files smells like the early world wide web and might feel a bit nostalgic.</p><p class="fancy__textFirstParagraph">Excited by the concept and new tools, I decided to create a personal blog. The first step was to select a framework. I went with <strong>Next.js</strong>, which seemed appealing mostly because of its use of <strong>React.js</strong> for rendering. Looking back at it now, it wasn&#x27;t the best choice. Not because Next is bad, but because generating static HTML is just the tip of the Next.js iceberg. More on that in a second. After finishing my dissertation project, I found time to finish off the blog and work on the content. I&#x27;m really happy with the final result and excited to share the insides of the project with you.</p><h1>Next.js</h1><p class="fancy__textFirstParagraph">Next&#x27;s presence on multiple &quot;top N static page generators&quot; lists might be a bit misleading. While it can output static HTML, the goal of this tool is to serve pre-rendered pages without sacrificing client-side interactivity. It does that by matching routes on the server-side, rendering the initial content, and returning the generated HTML to the client. Scripts included in the markup pull React components and their dependencies to recreate the state of the React app that rendered the page. When that process finishes, React runs as if nothing has happened. This technique is called <strong>rehydration</strong> and it allows developers to serve useful content without loading screens. What a clever solution!</p><p class="fancy__textFirstParagraph">However, my blog doesn&#x27;t need rehydration because its pages are truly static. The only thing I am interested in is the output of the initial render. Luckily, Next.js contains <a href="https://github.com/zeit/next.js/pull/11949">an experimental feature</a> that disables rehydration on selected pages. With it, I removed unnecessary scripts and saved around 300kB on the post page. All that&#x27;s left to do is to render a set of pages to HTML files. This can be done with a few short functions and commands.</p><h1>Execution</h1><p class="fancy__textFirstParagraph">My attempt at creating a blog was heavily guided by the articles below. Check them out if you want to learn about reading and rendering Markdown documents.</p><ul><li><a href="https://dev.to/tinacms/creating-a-markdown-blog-with-next-js-52hk">&quot;Creating a Markdown Blog with Next.js&quot; by Kendall Strautman</a></li><li><a href="https://medium.com/young-developer/react-markdown-code-and-syntax-highlighting-632d2f9b4ada">&quot;React Markdown â€” Code and Syntax Highlighting&quot; by Bexultan A. Myrzatayev</a></li></ul><p class="fancy__textFirstParagraph">Let&#x27;s take a look at the structure of my blog and examine interesting parts closely.</p><div class="Code"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none">.
â”œâ”€â”€ README.md
â”œâ”€â”€ package.json
â”œâ”€â”€ next.config.js
â”œâ”€â”€ crop_header.sh
â”œâ”€â”€ crop_post.sh
â”œâ”€â”€ crop.py
â”œâ”€â”€ public
â”‚   â””â”€â”€ assets
â”‚       â”œâ”€â”€ favicon.ico
â”‚       â”œâ”€â”€ avatar.webp
â”‚       â”œâ”€â”€ &lt;more public assets&gt;
â”‚       â””â”€â”€ type-narrowing-and-closures
â”‚           â”œâ”€â”€ README.md
â”‚           â”œâ”€â”€ header-m-1x.webp
â”‚           â””â”€â”€ &lt;more post assets&gt;
â”œâ”€â”€ data
â”‚Â Â  â”œâ”€â”€ config.json
â”‚Â Â  â””â”€â”€ tags.json
â”œâ”€â”€ posts
â”‚Â Â  â”œâ”€â”€ type-narrowing-and-closures.md
â”‚Â Â  â””â”€â”€ &lt;more posts&gt;
â””â”€â”€ src
    â”œâ”€â”€ pages
    â”‚Â Â  â”œâ”€â”€ _app.js
    â”‚Â Â  â”œâ”€â”€ index.js
    â”‚Â Â  â”œâ”€â”€ posts
    â”‚Â Â  â”‚Â Â  â””â”€â”€ [slug].js
    â”‚Â Â  â””â”€â”€ tags
    â”‚Â Â      â””â”€â”€ [slug].js
    â”œâ”€â”€ components
    â”‚Â Â  â”œâ”€â”€ PostHeader.js
    â”‚Â Â  â”œâ”€â”€ PostFooter.js
    â”‚Â Â  â””â”€â”€ &lt;more components&gt;
    â”œâ”€â”€ styles
    â”‚Â Â  â”œâ”€â”€ global.css
    â”‚Â Â  â”œâ”€â”€ variables.css
    â”‚Â Â  â”œâ”€â”€ index.css
    â”‚Â Â  â”œâ”€â”€ post-header.css
    â”‚Â Â  â””â”€â”€ &lt;more styles&gt;
    â””â”€â”€ utils.js</code></pre></div><h1>Image processing for responsive images</h1><p class="fancy__textFirstParagraph">As you know, responsive webpages should adapt to different viewports (mobile, tablet, desktop) and different pixel-density displays. If that was not complicated enough, some browsers don&#x27;t support modern image formats (yes, I&#x27;m looking at you, Safari). Manual cropping, scaling and converting input images, so that they cover all possible scenarios, would take forever. That&#x27;s why I created a few tools for automating this task. <code>crop.py</code> is a python script for image manipulation. Just like ImageMagic, but with a usable interface ðŸ˜›. <code>crop_header.sh</code> uses that tool to turn an input header image into multiple variants ready for display on post pages. <code>crop_post.sh</code> is similar but produces images for display in post content.</p><p class="fancy__textFirstParagraph">While <code>crop_post.sh</code> only scales the image, the header cropping script extracts central area an input image maintaining the desired aspect ratio for different viewport sizes.</p><figure><picture><source type="image/webp" srcSet="/assets/a-static-blog/crop-frames-post-1x.webp 830w, /assets/a-static-blog/crop-frames-post-2x.webp 1660w" sizes="(min-height: 660px) 660px, 100vw"/><source type="image/jpg" srcSet="/assets/a-static-blog/crop-frames-post-1x.jpg 830w, /assets/a-static-blog/crop-frames-post-2x.jpg 1660w" sizes="(min-height: 660px) 660px, 100vw"/><img class="fancy__image" src="/assets/a-static-blog/crop-frames-post-1x.jpg" alt="Crop frames"/></picture><figcaption>Frames showing how the original header image will be cropped for different viewports.</figcaption></figure><p class="fancy__textFirstParagraph">Here is how I run these two scripts.</p><div class="Code"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#DD4A68">bash</span> crop_header.sh ~/input.jpg public/assets/post-slug/
<span class="token" style="color:#DD4A68">bash</span> crop_post.sh ~/input.jpg public/assets/post-slug/ new-name</code></pre></div><p class="fancy__textFirstParagraph">Asking the browser to display correct files is quite challenging too. <a href="https://developer.mozilla.org/en-US/docs/Learn/HTML/Multimedia_and_embedding/Responsive_images">Responsive images article</a> on MDN is an invaluable resource when working with the <code>picture</code> tag and the <code>srcset</code> attribute. The following snippet contains instructions for displaying mobile sized <em>webp</em> header images in two pixel density variants. In the real header component I repeated the source element for all image formats and all viewport sizes!</p><div class="Code"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#905"><span class="token" style="color:#905"><span class="token" style="color:#999">&lt;</span>picture</span><span class="token" style="color:#999">&gt;</span></span><span class="token plain-text">
  </span><span class="token" style="color:#905"><span class="token" style="color:#905"><span class="token" style="color:#999">&lt;</span>source</span>
    <span class="token" style="color:#690">type</span><span class="token" style="color:#07a"><span class="token" style="color:#999">=</span><span class="token" style="color:#999">&quot;</span>image/webp<span class="token" style="color:#999">&quot;</span></span>
    <span class="token" style="color:#690">media</span><span class="token" style="color:#07a"><span class="token" style="color:#999">=</span><span class="token" style="color:#999">&quot;</span>(max-width:  480px)<span class="token" style="color:#999">&quot;</span></span>
    <span class="token" style="color:#690">srcSet</span><span class="token script language-javascript"><span class="token script-punctuation" style="color:#999">=</span><span class="token" style="color:#999">{</span><span class="token template-string"><span class="token template-punctuation" style="color:#690">`</span><span class="token" style="color:#690">/assets/</span><span class="token interpolation"><span class="token interpolation-punctuation" style="color:#999">${</span>slug<span class="token interpolation-punctuation" style="color:#999">}</span></span><span class="token" style="color:#690">/header-s-2x.webp 960w,
             /assets/</span><span class="token interpolation"><span class="token interpolation-punctuation" style="color:#999">${</span>slug<span class="token interpolation-punctuation" style="color:#999">}</span></span><span class="token" style="color:#690">/header-s-1x.webp 480w</span><span class="token template-punctuation" style="color:#690">`</span></span><span class="token" style="color:#999">}</span></span>
  <span class="token" style="color:#999">/&gt;</span></span><span class="token plain-text">
  </span><span class="token" style="color:#999">{</span><span class="token" style="color:slategray">/* more sources here */</span><span class="token" style="color:#999">}</span><span class="token plain-text">
  </span><span class="token" style="color:#905"><span class="token" style="color:#905"><span class="token" style="color:#999">&lt;</span>img</span>
    <span class="token" style="color:#690">src</span><span class="token script language-javascript"><span class="token script-punctuation" style="color:#999">=</span><span class="token" style="color:#999">{</span><span class="token template-string"><span class="token template-punctuation" style="color:#690">`</span><span class="token" style="color:#690">/assets/</span><span class="token interpolation"><span class="token interpolation-punctuation" style="color:#999">${</span>slug<span class="token interpolation-punctuation" style="color:#999">}</span></span><span class="token" style="color:#690">/header-m-1x.jpg</span><span class="token template-punctuation" style="color:#690">`</span></span><span class="token" style="color:#999">}</span></span>
    <span class="token" style="color:#690">alt</span><span class="token" style="color:#07a"><span class="token" style="color:#999">=</span><span class="token" style="color:#999">&quot;</span>header image<span class="token" style="color:#999">&quot;</span></span>
  <span class="token" style="color:#999">/&gt;</span></span><span class="token plain-text">
  </span><span class="token" style="color:#905"><span class="token" style="color:#905"><span class="token" style="color:#999">&lt;/</span>picture</span><span class="token" style="color:#999">&gt;</span></span></code></pre></div><h1>Public assets</h1><p><code>public/assets</code> folder contains assets like icons and avatars. Because Next.js copies contents of <code>public</code> folder into the build folder, webpages can reference assets using URLs starting with <code>/assets</code>, e.g. <code>&lt;img src=&quot;/assets/avatar.webp&quot; alt=&quot;&quot; /&gt;</code>.</p><p><code>public/assets/&lt;post-slug&gt;</code> folders store assets used by posts with matching slugs. These are mostly images created by the previously mentioned <code>crop_header.sh</code> and <code>crop_post.sh</code> scripts. README files are for asset credits.</p><h1>Content</h1><p><code>data</code> directory is a place for <strong>JSON</strong> files with global data used by the blog. <code>config.json</code> stores author data and webpage title. <code>tags.json</code> contains all post tags, as well as their titles and colors. These files are loaded by page components, which will be described later.</p><p><code>posts</code> folder contains my <strong>Markdown</strong>-formatted posts. The name of a Markdown file is used as a slug in post URLs, e.g. <code>/posts/type-narrowing-and-closures</code>. Every document starts with <strong>YAML front matter</strong> describing metadata of a post. That metadata lands in many places in the rendered HTML: on post&#x27;s page, in previews, and head&#x27;s <code>title</code>, and <code>meta</code> elements.</p><div class="Code"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#999">---</span>
<span class="token key" style="color:#07a">title</span><span class="token" style="color:#999">:</span> <span class="token" style="color:#690">&quot;This is my post&quot;</span>
<span class="token key" style="color:#07a">short</span><span class="token" style="color:#999">:</span> <span class="token" style="color:#690">&quot;Here is its short description shown in previews.&quot;</span>
<span class="token key" style="color:#07a">tags</span><span class="token" style="color:#999">:</span> <span class="token" style="color:#690">&quot;javascript,typescript&quot;</span>
<span class="token key" style="color:#07a">published</span><span class="token" style="color:#999">:</span> <span class="token datetime" style="color:#905">2020-01-01</span>
<span class="token key" style="color:#07a">background</span><span class="token" style="color:#999">:</span> <span class="token" style="color:#690">&quot;#282828&quot;</span>
<span class="token" style="color:#999">---</span>
Document content goes here<span class="token" style="color:#999">...</span></code></pre></div><h1>Routing</h1><p class="fancy__textFirstParagraph">A typical React application decides what content should be shown by matching URL after the app has started. In Next.js, routes are represented by <strong>page files</strong> and folders inside <code>src/pages</code>. The root page <code>/</code> is rendered by <code>index.js</code>. <code>/hello</code> would try to render <code>hello.js</code>, and nested URLs like <code>posts/first</code> would search for <code>posts/first.js</code>. Simple stuff so far.</p><p class="fancy__textFirstParagraph">Routes can be more dynamic. If a file name contains parameters in square brackets, e.g. <code>tags/[slug].js</code>, it will match many URLs, e.g. <code>/tags/javascript</code>, <code>/tags/react</code>, <code>/tags/next</code>. JavaScript page files can access these parameters and render different content for different URLs.</p><p class="fancy__textFirstParagraph">My blog uses the following files to render posts, tags and the index page.</p><div class="Code"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none">src/pages/index.js
src/pages/posts/[slug].js
src/pages/tags/[slug].js</code></pre></div><p class="fancy__textFirstParagraph">How do we tell Next.js what URLs it should render during a build? Using <code>getStaticPaths</code> function. When exported from a page file, this function tells the &quot;compiler&quot; to render pages with different parameters. The following snippets show how I request the generation of tag pages.</p><div class="Code"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// src/pages/tags/[slug].js</span>

<span class="token module" style="color:#07a">export</span> <span class="token" style="color:#07a">async</span> <span class="token" style="color:#07a">function</span> <span class="token" style="color:#DD4A68">getStaticPaths</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span> <span class="token" style="color:#999">{</span>
  <span class="token" style="color:#07a">const</span> tags <span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span> <span class="token" style="color:#999">(</span><span class="token" style="color:#07a">await</span> <span class="token module" style="color:#07a">import</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&#x27;../../../data/tags.json&#x27;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">.</span><span class="token module" style="color:#07a">default</span><span class="token" style="color:#999">;</span>

  <span class="token" style="color:#07a">return</span> <span class="token" style="color:#999">{</span>
    fallback<span class="token" style="color:#999">:</span> <span class="token" style="color:#905">false</span><span class="token" style="color:#999">,</span>
    paths<span class="token" style="color:#999">:</span> <span class="token known-class-name" style="color:#DD4A68">Object</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">keys</span><span class="token" style="color:#999">(</span>tags<span class="token" style="color:#999">)</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">map</span><span class="token" style="color:#999">(</span><span class="token parameter">slug</span> <span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span> <span class="token" style="color:#999">(</span><span class="token" style="color:#999">{</span>
      params<span class="token" style="color:#999">:</span> <span class="token" style="color:#999">{</span> slug <span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span>
    <span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">,</span>
  <span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span>
<span class="token" style="color:#999">}</span></code></pre></div><div class="Code"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// data/tags.json</span>

<span class="token" style="color:#999">{</span>
  <span class="token" style="color:#690">&quot;typescript&quot;</span><span class="token" style="color:#999">:</span> <span class="token" style="color:#999">{</span>
    <span class="token" style="color:#690">&quot;title&quot;</span><span class="token" style="color:#999">:</span> <span class="token" style="color:#690">&quot;TypeScript&quot;</span><span class="token" style="color:#999">,</span>
    <span class="token" style="color:#690">&quot;color&quot;</span><span class="token" style="color:#999">:</span> <span class="token" style="color:#690">&quot;#294e80&quot;</span>
  <span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span>
  <span class="token" style="color:#690">&quot;markdown&quot;</span><span class="token" style="color:#999">:</span> <span class="token" style="color:#999">{</span>
    <span class="token" style="color:#690">&quot;title&quot;</span><span class="token" style="color:#999">:</span> <span class="token" style="color:#690">&quot;Markdown&quot;</span><span class="token" style="color:#999">,</span>
    <span class="token" style="color:#690">&quot;color&quot;</span><span class="token" style="color:#999">:</span> <span class="token" style="color:#690">&quot;#000000&quot;</span>
  <span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span>
  <span class="token" style="color:slategray">// ...</span>
<span class="token" style="color:#999">}</span></code></pre></div><h1>Pages</h1><p class="fancy__textFirstParagraph">Single page applications fetch data from APIs asynchronously. In Next, page components are not rendered until the exported <code>getStaticProps</code> function resolves with page props. This function is a good place to ask an API for data or read files from disk before you render the HTML.</p><p class="fancy__textFirstParagraph">Warning: <code>getStaticProps</code> works only with static generation. For server-side rendering, you need to implement <code>getServerSideProps</code> function.</p><p class="fancy__textFirstParagraph">Here is how I prepare data for post rendering.</p><div class="Code"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// src/pages/posts/[slug].js</span>

<span class="token module" style="color:#07a">import</span> <span class="token" style="color:#999">{</span> getPosts <span class="token" style="color:#999">}</span> <span class="token module" style="color:#07a">from</span> <span class="token" style="color:#690">&#x27;../../utils&#x27;</span><span class="token" style="color:#999">;</span>

<span class="token module" style="color:#07a">export</span> <span class="token" style="color:#07a">async</span> <span class="token" style="color:#07a">function</span> <span class="token" style="color:#DD4A68">getStaticProps</span><span class="token" style="color:#999">(</span><span class="token parameter">context</span><span class="token" style="color:#999">)</span> <span class="token" style="color:#999">{</span>
  <span class="token" style="color:slategray">// extract slug from url</span>
  <span class="token" style="color:#07a">const</span> <span class="token" style="color:#999">{</span> slug <span class="token" style="color:#999">}</span> <span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span> context<span class="token" style="color:#999">.</span><span class="token property-access">params</span><span class="token" style="color:#999">;</span>

  <span class="token" style="color:slategray">// read config, tags and posts</span>
  <span class="token" style="color:#07a">const</span> config <span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span> <span class="token" style="color:#999">(</span><span class="token" style="color:#07a">await</span> <span class="token module" style="color:#07a">import</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&#x27;path-to-config-json&#x27;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">.</span><span class="token module" style="color:#07a">default</span><span class="token" style="color:#999">;</span>
  <span class="token" style="color:#07a">const</span> tags <span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span> <span class="token" style="color:#999">(</span><span class="token" style="color:#07a">await</span> <span class="token module" style="color:#07a">import</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&#x27;path-to-tags-json&#x27;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">.</span><span class="token module" style="color:#07a">default</span><span class="token" style="color:#999">;</span>
  <span class="token" style="color:#07a">const</span> posts <span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span> <span class="token" style="color:#DD4A68">getPosts</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span>

  <span class="token" style="color:slategray">// find the post to render + its neighbors</span>
  <span class="token" style="color:#07a">const</span> index <span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span> posts<span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">findIndex</span><span class="token" style="color:#999">(</span><span class="token parameter">post</span> <span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span> post<span class="token" style="color:#999">.</span><span class="token property-access">slug</span> <span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">===</span> slug<span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span>

  <span class="token" style="color:#07a">const</span> post <span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span> posts<span class="token" style="color:#999">[</span>index<span class="token" style="color:#999">]</span><span class="token" style="color:#999">;</span>
  <span class="token" style="color:#07a">const</span> nextPost <span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span> posts<span class="token" style="color:#999">[</span>index<span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">-</span><span class="token" style="color:#905">1</span><span class="token" style="color:#999">]</span> <span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">?</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">?</span> <span class="token null nil" style="color:#07a">null</span><span class="token" style="color:#999">;</span>
  <span class="token" style="color:#07a">const</span> prevPost <span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span> posts<span class="token" style="color:#999">[</span>index<span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">+</span><span class="token" style="color:#905">1</span><span class="token" style="color:#999">]</span> <span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">?</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">?</span> <span class="token null nil" style="color:#07a">null</span><span class="token" style="color:#999">;</span>

  <span class="token" style="color:slategray">// prepare props</span>
  <span class="token" style="color:#07a">const</span> props <span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span> <span class="token" style="color:#999">{</span> post<span class="token" style="color:#999">,</span> nextPos<span class="token" style="color:#999">,</span> <span class="token maybe-class-name">PrevPost</span><span class="token" style="color:#999">,</span> config<span class="token" style="color:#999">,</span> tags <span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span>

  <span class="token" style="color:slategray">// return JSON-compatible version of props</span>
  <span class="token" style="color:#07a">return</span> <span class="token" style="color:#999">{</span>
    props<span class="token" style="color:#999">:</span> <span class="token known-class-name" style="color:#DD4A68">JSON</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">parse</span><span class="token" style="color:#999">(</span><span class="token known-class-name" style="color:#DD4A68">JSON</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">stringify</span><span class="token" style="color:#999">(</span>props<span class="token" style="color:#999">)</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">,</span>
  <span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span>
<span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span></code></pre></div><p class="fancy__textFirstParagraph">If you&#x27;re wondering how <code>getPosts</code> function looks like, check this out. It&#x27;s not that scary! It simply reads posts as text files and separates metadata from content using <code>gray-matter</code> library. Post are sorted by date, so I can show them in a sensible order.</p><div class="Code"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// src/utils.js</span>

<span class="token module" style="color:#07a">import</span> matter <span class="token module" style="color:#07a">from</span> <span class="token" style="color:#690">&#x27;gray-matter&#x27;</span><span class="token" style="color:#999">;</span>

<span class="token module" style="color:#07a">export</span> <span class="token" style="color:#07a">function</span> <span class="token" style="color:#DD4A68">getPosts</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span> <span class="token" style="color:#999">{</span>
  <span class="token" style="color:slategray">// read files from &#x27;posts&#x27; directory</span>
  <span class="token" style="color:#07a">const</span> dir <span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span> require<span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">context</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&#x27;../posts&#x27;</span><span class="token" style="color:#999">,</span> <span class="token" style="color:#905">true</span><span class="token" style="color:#999">,</span> <span class="token" style="color:#e90"><span class="token regex-delimiter">/</span><span class="token language-regex"><span class="token special-escape escape">\.</span>md<span class="token anchor">$</span></span><span class="token regex-delimiter">/</span></span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span>
  <span class="token" style="color:#07a">const</span> fileNames <span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span> dir<span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">keys</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span>
  <span class="token" style="color:#07a">const</span> fileValues <span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span> fileNames<span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">map</span><span class="token" style="color:#999">(</span>dir<span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span>

  <span class="token" style="color:#07a">const</span> posts <span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span> fileNames<span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">map</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">(</span><span class="token parameter">name<span class="token" style="color:#999">,</span> i</span><span class="token" style="color:#999">)</span> <span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span> <span class="token" style="color:#999">{</span>
    <span class="token" style="color:slategray">// slug = name without extension</span>
    <span class="token" style="color:#07a">const</span> slug <span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span> name<span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">match</span><span class="token" style="color:#999">(</span><span class="token" style="color:#e90"><span class="token regex-delimiter">/</span><span class="token language-regex"><span class="token escape">\/</span><span class="token group">(</span><span class="token charset"><span class="token charset-punctuation">[</span><span class="token charclass">\w</span>-<span class="token charset-punctuation">]</span></span><span class="token quantifier">+</span><span class="token group">)</span><span class="token special-escape escape">\.</span>md<span class="token anchor">$</span></span><span class="token regex-delimiter">/</span></span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">[</span><span class="token" style="color:#905">1</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">;</span>

    <span class="token" style="color:slategray">// parse text to separate metadata from content</span>
    <span class="token" style="color:#07a">const</span> parsed <span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span> <span class="token" style="color:#DD4A68">matter</span><span class="token" style="color:#999">(</span>fileValues<span class="token" style="color:#999">[</span>i<span class="token" style="color:#999">]</span><span class="token" style="color:#999">.</span><span class="token module" style="color:#07a">default</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span>
    <span class="token" style="color:#07a">const</span> meta <span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span> parsed<span class="token" style="color:#999">.</span><span class="token property-access">data</span><span class="token" style="color:#999">;</span>
    <span class="token" style="color:#07a">const</span> content <span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span> parsed<span class="token" style="color:#999">.</span><span class="token property-access">content</span><span class="token" style="color:#999">;</span>

    <span class="token" style="color:slategray">// post = slug + meta + content</span>
    <span class="token" style="color:#07a">return</span> <span class="token" style="color:#999">{</span> slug<span class="token" style="color:#999">,</span> meta<span class="token" style="color:#999">,</span> content <span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span>
  <span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span>

  <span class="token" style="color:slategray">// sort posts by publish date</span>
  posts<span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">sort</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">(</span><span class="token parameter">a<span class="token" style="color:#999">,</span> b</span><span class="token" style="color:#999">)</span> <span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span> b<span class="token" style="color:#999">.</span><span class="token property-access">meta</span><span class="token" style="color:#999">.</span><span class="token property-access">published</span> <span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">-</span> a<span class="token" style="color:#999">.</span><span class="token property-access">meta</span><span class="token" style="color:#999">.</span><span class="token property-access">published</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span>
  <span class="token" style="color:#07a">return</span> posts<span class="token" style="color:#999">;</span>
<span class="token" style="color:#999">}</span></code></pre></div><p class="fancy__textFirstParagraph">When the data is ready, Post component takes over and generates virtual HTML with post&#x27;s content. Here is a simplified version of the post component:</p><div class="Code"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// src/pages/posts/[slug].js</span>

<span class="token module" style="color:#07a">export</span> <span class="token module" style="color:#07a">default</span> <span class="token" style="color:#07a">function</span> <span class="token" style="color:#DD4A68"><span class="token maybe-class-name">Post</span></span><span class="token" style="color:#999">(</span><span class="token parameter"><span class="token" style="color:#999">{</span> post<span class="token" style="color:#999">,</span> nextPost<span class="token" style="color:#999">,</span> prevPost <span class="token" style="color:#999">}</span></span><span class="token" style="color:#999">)</span> <span class="token" style="color:#999">{</span>
  <span class="token" style="color:#07a">return</span> <span class="token" style="color:#999">(</span>
    <span class="token" style="color:#905"><span class="token" style="color:#905"><span class="token" style="color:#999">&lt;</span>div</span><span class="token" style="color:#999">&gt;</span></span><span class="token plain-text">
      </span><span class="token" style="color:#905"><span class="token" style="color:#905"><span class="token" style="color:#999">&lt;</span><span class="token" style="color:#DD4A68">Head</span></span><span class="token" style="color:#999">&gt;</span></span><span class="token plain-text">
        </span><span class="token" style="color:#905"><span class="token" style="color:#905"><span class="token" style="color:#999">&lt;</span>title</span><span class="token" style="color:#999">&gt;</span></span><span class="token" style="color:#999">{</span>post<span class="token" style="color:#999">.</span><span class="token property-access">meta</span><span class="token" style="color:#999">.</span><span class="token property-access">title</span><span class="token" style="color:#999">}</span><span class="token" style="color:#905"><span class="token" style="color:#905"><span class="token" style="color:#999">&lt;/</span>title</span><span class="token" style="color:#999">&gt;</span></span><span class="token plain-text">
        </span><span class="token" style="color:#905"><span class="token" style="color:#905"><span class="token" style="color:#999">&lt;</span>meta</span> <span class="token" style="color:#690">name</span><span class="token" style="color:#07a"><span class="token" style="color:#999">=</span><span class="token" style="color:#999">&quot;</span>description<span class="token" style="color:#999">&quot;</span></span> <span class="token" style="color:#690">content</span><span class="token script language-javascript"><span class="token script-punctuation" style="color:#999">=</span><span class="token" style="color:#999">{</span>post<span class="token" style="color:#999">.</span><span class="token property-access">meta</span><span class="token" style="color:#999">.</span><span class="token property-access">short</span><span class="token" style="color:#999">}</span></span> <span class="token" style="color:#999">/&gt;</span></span><span class="token plain-text">
        </span><span class="token" style="color:#999">{</span><span class="token" style="color:slategray">/* other metadata */</span><span class="token" style="color:#999">}</span><span class="token plain-text">
      </span><span class="token" style="color:#905"><span class="token" style="color:#905"><span class="token" style="color:#999">&lt;/</span><span class="token" style="color:#DD4A68">Head</span></span><span class="token" style="color:#999">&gt;</span></span><span class="token plain-text">

      </span><span class="token" style="color:#905"><span class="token" style="color:#905"><span class="token" style="color:#999">&lt;</span><span class="token" style="color:#DD4A68">PostHeader</span></span> <span class="token" style="color:#690">post</span><span class="token script language-javascript"><span class="token script-punctuation" style="color:#999">=</span><span class="token" style="color:#999">{</span>post<span class="token" style="color:#999">}</span></span> <span class="token" style="color:#999">/&gt;</span></span><span class="token plain-text">

      </span><span class="token" style="color:#905"><span class="token" style="color:#905"><span class="token" style="color:#999">&lt;</span><span class="token" style="color:#DD4A68">ReactMarkdown</span></span>
        <span class="token" style="color:#690">source</span><span class="token script language-javascript"><span class="token script-punctuation" style="color:#999">=</span><span class="token" style="color:#999">{</span>post<span class="token" style="color:#999">.</span><span class="token property-access">content</span><span class="token" style="color:#999">}</span></span>
        <span class="token" style="color:#690">renderers</span><span class="token script language-javascript"><span class="token script-punctuation" style="color:#999">=</span><span class="token" style="color:#999">{</span><span class="token" style="color:#999">{</span>
          code<span class="token" style="color:#999">:</span> <span class="token maybe-class-name">Code</span><span class="token" style="color:#999">,</span>
          paragraph<span class="token" style="color:#999">:</span> <span class="token maybe-class-name">Paragraph</span><span class="token" style="color:#999">,</span>
          <span class="token function-variable" style="color:#DD4A68">image</span><span class="token" style="color:#999">:</span> <span class="token parameter">props</span> <span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span> <span class="token" style="color:#905"><span class="token" style="color:#905"><span class="token" style="color:#999">&lt;</span><span class="token" style="color:#DD4A68">Image</span></span> <span class="token spread"><span class="token" style="color:#999">{</span><span class="token" style="color:#999">...</span><span class="token" style="color:#07a">props</span><span class="token" style="color:#999">}</span></span> <span class="token" style="color:#690">slug</span><span class="token script language-javascript"><span class="token script-punctuation" style="color:#999">=</span><span class="token" style="color:#999">{</span>post<span class="token" style="color:#999">.</span><span class="token property-access">slug</span><span class="token" style="color:#999">}</span></span> <span class="token" style="color:#999">/&gt;</span></span>
        <span class="token" style="color:#999">}</span><span class="token" style="color:#999">}</span></span>
      <span class="token" style="color:#999">/&gt;</span></span><span class="token plain-text">

      </span><span class="token" style="color:#905"><span class="token" style="color:#905"><span class="token" style="color:#999">&lt;</span><span class="token" style="color:#DD4A68">PostFooter</span></span> <span class="token" style="color:#999">/&gt;</span></span><span class="token plain-text">
    </span><span class="token" style="color:#905"><span class="token" style="color:#905"><span class="token" style="color:#999">&lt;/</span>div</span><span class="token" style="color:#999">&gt;</span></span>
  <span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span>
<span class="token" style="color:#999">}</span></code></pre></div><p><strong>ReactMarkdown</strong> component from &#x27;react-markdown&#x27; library turns my post documents into HTML. Notice how I override default renderers of that element. The <code>paragraph</code> renderer adds additional classes to paragraphs stating with text so that I can style them differently. The <code>image</code> renderer is quite interesting. It creates a figure with caption, making illustrations included in posts look a bit more professional. Furthermore, it renders images with a <code>picture</code> element containing both high and low pixel density images. <code>code</code>, as you might have guessed, renders code snippets with syntax highlighting.</p><p class="fancy__textFirstParagraph">The last piece of the puzzle is disabling rehydration. Hey, do you remember what it is? We can do that by exporting a config object from page components, just like that:</p><div class="Code"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token module" style="color:#07a">export</span> <span class="token" style="color:#07a">const</span> config <span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span> <span class="token" style="color:#999">{</span>
  unstable_runtimeJS<span class="token" style="color:#999">:</span> <span class="token" style="color:#905">false</span><span class="token" style="color:#999">,</span>
<span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span></code></pre></div><h1>Other code</h1><h2><code>_app.js</code></h2><p><code>_app.js</code> is an optional file living in <code>pages</code> folder. It&#x27;s useful for customizing the &quot;React bootstrapping&quot; process. If you want to import global CSS or add head elements, like <code>link</code>, <code>script</code>, or <code>meta</code>, to all pages, this is the right place. Because of Next&#x27;s early route matching, the application component receives matched page component and props, including URL parameters. All you need to do is render that page, like so:</p><div class="Code"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// src/pages/_app.js</span>

<span class="token module" style="color:#07a">import</span> <span class="token maybe-class-name">Head</span> <span class="token module" style="color:#07a">from</span> <span class="token" style="color:#690">&#x27;next/head&#x27;</span><span class="token" style="color:#999">;</span>

<span class="token module" style="color:#07a">import</span> <span class="token" style="color:#690">&#x27;../styles/variables.css&#x27;</span><span class="token" style="color:#999">;</span>
<span class="token module" style="color:#07a">import</span> <span class="token" style="color:#690">&#x27;../styles/global.css&#x27;</span><span class="token" style="color:#999">;</span>
<span class="token module" style="color:#07a">import</span> <span class="token" style="color:#690">&#x27;../styles/post.css&#x27;</span><span class="token" style="color:#999">;</span>
<span class="token" style="color:slategray">// more css imports here</span>

<span class="token module" style="color:#07a">export</span> <span class="token module" style="color:#07a">default</span> <span class="token" style="color:#07a">function</span> <span class="token" style="color:#DD4A68"><span class="token maybe-class-name">App</span></span><span class="token" style="color:#999">(</span><span class="token parameter"><span class="token" style="color:#999">{</span> <span class="token maybe-class-name">Component</span><span class="token" style="color:#999">,</span> pageProps <span class="token" style="color:#999">}</span></span><span class="token" style="color:#999">)</span> <span class="token" style="color:#999">{</span>
  <span class="token" style="color:#07a">return</span> <span class="token" style="color:#999">(</span>
    <span class="token" style="color:#905"><span class="token" style="color:#905"><span class="token" style="color:#999">&lt;</span></span><span class="token" style="color:#999">&gt;</span></span><span class="token plain-text">
      </span><span class="token" style="color:#905"><span class="token" style="color:#905"><span class="token" style="color:#999">&lt;</span><span class="token" style="color:#DD4A68">Head</span></span><span class="token" style="color:#999">&gt;</span></span><span class="token plain-text">
        </span><span class="token" style="color:#999">{</span><span class="token" style="color:slategray">/* favicon, meta, stylesheets, and scripts go here */</span><span class="token" style="color:#999">}</span><span class="token plain-text">
        </span><span class="token" style="color:#905"><span class="token" style="color:#905"><span class="token" style="color:#999">&lt;</span>link</span> <span class="token" style="color:#690">href</span><span class="token" style="color:#07a"><span class="token" style="color:#999">=</span><span class="token" style="color:#999">&quot;</span>my-font-source<span class="token" style="color:#999">&quot;</span></span> <span class="token" style="color:#690">rel</span><span class="token" style="color:#07a"><span class="token" style="color:#999">=</span><span class="token" style="color:#999">&quot;</span>stylesheet<span class="token" style="color:#999">&quot;</span></span> <span class="token" style="color:#999">/&gt;</span></span><span class="token plain-text">
      </span><span class="token" style="color:#905"><span class="token" style="color:#905"><span class="token" style="color:#999">&lt;/</span><span class="token" style="color:#DD4A68">Head</span></span><span class="token" style="color:#999">&gt;</span></span><span class="token plain-text">
      </span><span class="token" style="color:#999">{</span><span class="token" style="color:slategray">/* render the page */</span><span class="token" style="color:#999">}</span><span class="token plain-text">
      </span><span class="token" style="color:#905"><span class="token" style="color:#905"><span class="token" style="color:#999">&lt;</span><span class="token" style="color:#DD4A68">Component</span></span> <span class="token spread"><span class="token" style="color:#999">{</span><span class="token" style="color:#999">...</span><span class="token" style="color:#07a">pageProps</span><span class="token" style="color:#999">}</span></span> <span class="token" style="color:#999">/&gt;</span></span><span class="token plain-text">
    </span><span class="token" style="color:#905"><span class="token" style="color:#905"><span class="token" style="color:#999">&lt;/</span></span><span class="token" style="color:#999">&gt;</span></span>
  <span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span>
<span class="token" style="color:#999">}</span></code></pre></div><h2>Styles</h2><p class="fancy__textFirstParagraph">Next.js comes with support for <strong>CSS modules</strong> (<code>.module.css</code>). Their per-file class name mangling is a great solution to CSS collision problems. While CSS modules can be imported from any JavaScript file, the traditional CSS can only be imported in <code>_app.js</code>. That&#x27;s exactly where I put all my stylesheets since this project relies on global CSS exclusively.</p><p class="fancy__textFirstParagraph">I must mention the use of <strong>CSS variables</strong>. For some strange reason, the community has not adopted that technology, despite its <a href="https://caniuse.com/#search=css%20variables">high browser compatibility</a> (94.81% of browsers as of 2020-05). In my project, variables describing fonts, font sizes, and colors live in the <code>variables.css</code> file. Styles shared between pages are placed in <code>global.css</code>. All other CSS files are responsible for styling components.</p><p class="fancy__textFirstParagraph">To cope with class collisions and give stylesheets a solid backbone, I followed <a href="http://getbem.com/">BEM methodology</a>. Well, with some small modifications. I name BEM components with <em>PascalCase</em> and BEM elements with <em>camelCase</em>. All in all, I am really happy with how styles turned out. My blog looks pretty both in the browser and in the editor!</p><h2>Components</h2><p class="fancy__textFirstParagraph">Separating independent units of the user interface is a common practice in front-end frameworks. It encourages reusability and makes complex applications more manageable. Components of this blog live in <code>src/components</code> folder.</p><h1>Results and conclusion</h1><p class="fancy__textFirstParagraph">The source code of the blog is <a href="https://github.com/prk3/blog-source">available on GitHub</a>. Generating truly static and lightweight pages required a bit of effort, mostly because of rehydration, which can be disabled only with the undocumented, experimental feature of Next. All in all, I am happy with the result and will definitely put the blog into use.</p><p class="fancy__textFirstParagraph">Would I use static generation in serious, not &quot;for-fun&quot; projects? Probably not. It&#x27;s hard to deny that static pages are not very useful these days. Even the most obvious use cases of static site generation, like blogs or documentation pages, benefit greatly from dynamic content such as comments or search results. Maybe it&#x27;s good enough for static portfolio pages? In the end, if you need to make a hole in a slice of bread, it does not matter if you use your finger, a screwdriver, or an electric drill.</p><p class="fancy__textFirstParagraph">Next.js is not a regular static site generator. It&#x27;s a framework that brings together the best of three worlds: static generation, server-side rendering, and client-side interactive interfaces. If you think how React applications are usually loaded and run, you realize that with Next&#x27;s server-side rendering you can speed up the initial render by skipping up to 3 sequential HTTP requests. This is a massive improvement especially for users with a poor internet connection. I would like to see how Next is used in more complex products. Are the benefits worth the transition from pure React? Does Next maintain the separation of back-end logic from user interface logic?</p></div></div><footer class="PostFooter"><div class="PostFooter__column"><h1 class="PostFooter__title">Thanks for reading!</h1><p class="PostFooter__message"><span>Want to ask a question or discuss the topic? Found a mistake?</span><br/><span>Open a </span><a class="link--clean" href="https://github.com/prk3/blog-source/issues">github issue</a><span>!</span></p><nav class="PostFooter__nav"><div class="PostFooter__next"><div class="PostRef PostRef--left"><a class="PostRef__link" href="/posts/type-narrowing-and-closures"><div class="PostRef__label">Next post</div><h6 class="PostRef__title">Type narrowing and closures</h6><div class="PostRef__arrow">â®</div></a></div></div><div class="PostFooter__back"><a class="PostFooter__backLink" href="/">Home</a></div><div class="PostFooter__prev"></div></nav></div></footer></div></div></body></html>